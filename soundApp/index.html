<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <audio id='myAudio'></audio>
    <button id='soundButton' onclick="playAudio()" type="button">Play Sounds</button>
    <button id='stopSoundButton' onclick="stopAudio()" type="button">Stop sounds</button>
</body>
<script>
    Array.prototype.random = function () {
        return this[Math.floor((Math.random() * this.length))];
    }
    const myAudio = document.getElementById('myAudio');
    const myAudioSounds = ['salamisound-1454157-birds-in-the-forest-with-a.mp3'];
    myAudio.setAttribute('src', myAudioSounds.random());

    function playAudio() {
        myAudio.play();
        fadeVolume(myAudio, 'fadeIn', 300);
    }

    function stopAudio() {
        myAudio.pause();
        myAudio.currentTime = 0;
    }

    myAudio.onended = async function () {
        // const randomWait = Math.random() * 100;
        // await new Promise(resolve => setTimeout(resolve, randomWait * 1000));
        myAudio.setAttribute('src', myAudioSounds.random());
        playAudio();
    }

    async function fadeVolume(element, fadeInOrOut, fadeDuration) {
        let incrementalValue = 0.05;
        if(fadeInOrOut === 'fadeIn') {
            element.volume = 0;
        } else if (fadeInOrOut === 'fadeOut') {
            element.volume = 1;
            incrementalValue = -incrementalValue;
        } else {
            throw new Error("Please choose either fade in or fade out, the following is not valid: " + fadeInOrOut);
        }
        for(var i = 0; i < 1/Math.abs(incrementalValue); i++){
            await new Promise(resolve => setTimeout(resolve, fadeDuration));
            element.volume = parseFloat(element.volume + incrementalValue).toPrecision(15)
            console.log('volume', element.volume);
        }
    }




</script>

<html>